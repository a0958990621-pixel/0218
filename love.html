<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>çµ¦ æ›¾â˜ï¸ğŸ’— çš„æ•…äº‹æ›¸ - ç¬¬äºŒå†Š</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap');
        :root { --primary: #8d6e63; --accent: #e6beae; --bg: #fffcf9; --text: #2c2c2c; --polaroid: #ffffff; --soft-red: #e63946; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: var(--bg); font-family: "PingFang TC", sans-serif; overflow: hidden; color: var(--text); }
        .book { position: relative; width: 100%; height: 100vh; perspective: 2500px; }
        .page { position: absolute; width: 100%; height: 100%; top: 0; left: 0; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; background: var(--bg); transform-origin: left center; transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1), opacity 0.8s ease; backface-visibility: hidden; z-index: var(--z); }
        .page.flipped { transform: rotateY(-170deg) translateX(-50px); opacity: 0; pointer-events: none; }
        .polaroid { background: var(--polaroid); padding: 10px 10px 100px 10px; box-shadow: 0 15px 45px rgba(0,0,0,0.1); transform: rotate(-1deg); max-width: 95%; width: 340px; position: relative; }
        .media-container { width: 100%; background: #fcfcfc; overflow: hidden; position: relative; display: flex; justify-content: center; align-items: center; min-height: 200px; }
        .scratch-overlay { position: absolute; inset: 0; background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%); backdrop-filter: blur(5px); z-index: 5; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: 0.8s; border-radius: 2px; }
        .scratch-overlay::after { content: "TAP TO REVEAL âœ¨"; color: #ad8a8a; font-size: 14px; }
        .scratch-overlay.revealed { opacity: 0; pointer-events: none; }
        video, img { max-width: 100%; max-height: 38vh; object-fit: contain; }
        .caption-tag { position: absolute; bottom: 15px; left: 0; width: 100%; text-align: center; font-size: 19px; color: #4a4a4a; line-height: 1.6; font-family: 'Noto Serif TC', serif; }
        .date-label { font-family: 'Noto Serif TC', serif; font-weight: 700; font-size: 1.3rem; color: var(--primary); margin-bottom: 20px; border-bottom: 2px solid var(--accent); }
        .nav-controls { position: fixed; bottom: 95px; width: 100%; display: flex; justify-content: center; gap: 30px; z-index: 1000; }
        .btn { background: white; color: var(--primary); border: 1.5px solid var(--accent); padding: 12px 35px; border-radius: 50px; cursor: pointer; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .day-counter-card { background: white; padding: 30px; border-radius: 30px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.1); width: 85%; max-width: 320px; }
        .day-number { font-size: 60px; font-weight: 700; color: var(--soft-red); font-family: 'Noto Serif TC', serif; margin: 10px 0; display: block; }
        #letter { display: none; background: white; padding: 40px 30px; border-radius: 20px; opacity: 0; max-width: 400px; border-left: 8px solid var(--accent); }
        #letter p { margin-bottom: 22px; opacity: 0; transform: translateY(12px); transition: 1.5s; font-family: 'Noto Serif TC', serif; line-height: 2; font-size: 20px; }
        .show-p { opacity: 1 !important; transform: translateY(0) !important; }
    </style>
</head>
<body onclick="wakeUpAudio()">

    <audio id="music-2" loop><source src="äº”æœˆå¤©-ç‚ºä½ å¯«ä¸‹é€™é¦–æƒ…æ­Œ.mp3"></audio>

    <div class="book" style="display:block;">
        <div class="page" style="--z: 110;"><div class="date-label">2025 / 04 / 24</div><div class="polaroid"><div class="media-container"><div class="scratch-overlay" onclick="reveal(this)"></div><img src="åœ¨ä¸€èµ·.jpg"></div><div class="caption-tag">é€™ä¸€å¤©ï¼Œæˆ‘å€‘åœ¨ä¸€èµ·äº† â¤ï¸</div></div></div>
        
        <div class="page" style="--z: 100;"><div class="date-label">2025 / 04 / 25</div><div class="polaroid"><div class="media-container"><div class="scratch-overlay" onclick="reveal(this)"></div><img src="0425.jpg"></div><div class="caption-tag">ç¬¬ä¸€æ¬¡ç‰½æ‰‹æ™‚ä½ èªª<br>é‚„æ˜¯è¦å†ç‰½ä¸€ä¸‹å•Šå•Šå•Š</div></div></div>
        <div class="page" style="--z: 10;" id="day-counter-page">
            <div class="date-label">Future</div>
            <div class="day-counter-card"><p>æˆ‘å€‘å·²ç¶“åœ¨ä¸€èµ·</p><span id="days-val" class="day-number">0</span><p>DAYS</p></div>
            <p style="margin-top: 30px; color: #888; font-style: italic;">ã€Œæ¯å¤©çœé–‹çœ¼ï¼Œæ„›å¦³åˆå¤šäº†ä¸€å¤©ã€‚ã€</p>
        </div>

        <div class="page" style="--z: 1;">
            <div id="letter">
                <p style="font-weight: 700; color: var(--primary); font-size: 24px;">ã€Œè‡³æˆ‘çš„ 100 åˆ†å¥³å­©ã€‚ã€</p>
                <p>é›–ç„¶æˆ‘å¯èƒ½ä¸æ˜¯ä½ å–œæ­¡çš„å¸¥å“¥ï¼Œä½†æˆ‘æœƒç”¨ç›¡å…¨åŠ›å°å¦³å¥½çš„</p>
                <p>æœªä¾†æˆ‘å€‘ä¸€å®šæœƒä¸€èµ·å‰µé€ æ›´å¤šç¾å¥½çš„æ•…äº‹ï¼</p>
                <p style="color:#e63946; font-size:2.2em; font-weight:bold; margin-top:30px !important; letter-spacing: 5px; text-align: center;">æˆ‘æ„›å¦³ï¼Œæ›¾â˜ï¸ğŸ’—</p>
            </div>
        </div>

        <div class="nav-controls"><button class="btn" id="prevBtn" onclick="prevPage()" disabled>PREV</button><button class="btn" id="nextBtn" onclick="nextPage()">NEXT</button></div>
    </div>

    <script>
        let curr = 0; const pages = document.querySelectorAll('.page');
        const m2 = document.getElementById('music-2');

        function reveal(overlay) { overlay.classList.add('revealed'); }
        
        // é—œéµï¼šç¢ºä¿éŸ³æ¨‚æ’­æ”¾çš„æ©Ÿåˆ¶
        function wakeUpAudio() { 
            if (m2.paused) m2.play().catch(()=>{}); 
        }

        // ä¸€é€²ä¾†é é¢å°±å˜—è©¦æ’­éŸ³æ¨‚ï¼ˆé€šå¸¸éœ€è¦é»æ“Šè¢å¹•ä¸€æ¬¡ï¼‰
        window.onload = () => { 
            loadVideo(0); 
            m2.play().catch(() => {
                console.log("ç­‰å¾…é»æ“Šè¢å¹•ä»¥å•Ÿå‹•éŸ³æ¨‚");
            });
        };

        function loadVideo(index) {
            const v = pages[index].querySelector('.page-video');
            if(v && (!v.src || v.src === "")) { v.src = v.getAttribute('data-src'); v.load(); v.onended = v.onpause = wakeUpAudio; }
        }

        function nextPage() {
            if (curr < pages.length - 1) {
                const v = pages[curr].querySelector('video'); if(v) v.pause();
                pages[curr].classList.add('flipped'); curr++; 
                loadVideo(curr); updateButtons(); wakeUpAudio();
                if (pages[curr].id === "day-counter-page") runAnimateDays();
                if (curr === pages.length - 1) showLetter();
            }
        }

        function prevPage() {
            if (curr > 0) {
                const v = pages[curr].querySelector('video'); if(v) v.pause();
                curr--; pages[curr].classList.remove('flipped'); 
                loadVideo(curr); updateButtons(); wakeUpAudio();
                if (pages[curr].id === "day-counter-page") runAnimateDays();
            }
        }

        function updateButtons() {
            document.getElementById('prevBtn').disabled = (curr === 0);
            document.getElementById('nextBtn').disabled = (curr === pages.length - 1);
        }

        function runAnimateDays() {
            const targetEl = document.getElementById('days-val');
            const startDate = new Date("2025/04/24");
            const today = new Date();
            const targetDays = Math.floor((today.getTime() - startDate.getTime()) / (1000 * 3600 * 24));
            let count = 0; targetEl.innerText = "0";
            const timer = setInterval(() => {
                let step = Math.ceil(targetDays / 40);
                count += step;
                if (count >= targetDays) { targetEl.innerText = targetDays; clearInterval(timer); }
                else { targetEl.innerText = count; }
            }, 30);
        }

        function showLetter() {
            const lt = document.getElementById('letter'); lt.style.display = 'block';
            setTimeout(()=>lt.style.opacity='1',10);
            lt.querySelectorAll('p').forEach((p,i)=>setTimeout(()=>p.classList.add('show-p'),i * 1800));
        }

        window.addEventListener('keydown', (e) => {
            if (e.key === "ArrowRight" || e.key === " ") nextPage();
            else if (e.key === "ArrowLeft") prevPage();
        });
    </script>
</body>
</html>